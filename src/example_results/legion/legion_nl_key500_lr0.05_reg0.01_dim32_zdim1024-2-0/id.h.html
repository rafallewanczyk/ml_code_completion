<!DOCTYPE html>
<html>
<head>
<style>
span.c {
    background-color: #CCFFCC;
}
span.pc {
    background-color: #FFEEBB;
}
span.w {
    background-color: #FFCCCC;
}
</style>
</head>
<body>
<pre>




<span class="w">#ifndef</span> <span class="w">REALM_ID_H</span>
<span class="w">#define</span> <span class="w">REALM_ID_H</span>


<span class="w">#ifdef</span> <span class="w">LEGION_IDS_ARE_64BIT</span>
<span class="w">#</span>  <span class="w">define</span> <span class="w">REALM_IDS_ARE_64BIT</span>
<span class="w">#endif</span>

<span class="w">namespace</span> <span class="w">Realm</span> <span class="w">{</span>

    <span class="w">class</span> <span class="w">ID</span> <span class="w">{</span>
    <span class="w">public:</span>
<span class="w">#ifdef</span> <span class="w">REALM_IDS_ARE_64BIT</span>
      <span class="w">typedef</span> <span class="w">unsigned</span> <span class="w">long</span> <span class="w">long</span> <span class="w">IDType;</span>

      <span class="w">enum</span> <span class="w">{</span>
	<span class="w">TYPE_BITS</span> <span class="w">=</span> <span class="w">4,</span>
	<span class="w">INDEX_H_BITS</span> <span class="w">=</span> <span class="w">12</span><span class="c">,</span>
	<span class="w">INDEX_L_BITS</span> <span class="pc">=</span> <span class="w">32</span><span class="pc">,</span>
	<span class="w">INDEX_BITS</span> <span class="pc">=</span> <span class="w">I</span><span class="c">NDEX_H_BITS</span> <span class="w">+</span> <span class="pc">I</span><span class="c">NDEX_L_BITS</span><span class="pc">,</span>
	<span class="w">NODE_BITS</span> <span class="pc">=</span> <span class="w">64</span> <span class="w">-</span> <span class="pc">T</span><span class="c">YPE_BITS</span> <span class="w">-</span> <span class="w">I</span><span class="pc">NDEX_B</span><span class="c">ITS</span> 
      <span class="w">}</span><span class="c">;</span>
<span class="c">#</span><span class="pc">el</span><span class="c">se</span>
      
      
      
      
      
      
      
      

      <span class="w">t</span><span class="pc">y</span><span class="c">pedef</span> <span class="pc">u</span><span class="c">nsigned</span> <span class="w">i</span><span class="c">nt</span> <span class="w">I</span><span class="pc">D</span><span class="c">Type</span><span class="pc">;</span>

      <span class="w">e</span><span class="pc">n</span><span class="c">um</span> <span class="c">{</span>
	<span class="w">T</span><span class="c">YPE_BITS</span> <span class="c">=</span> <span class="w">4</span><span class="c">,</span>
	<span class="w">I</span><span class="pc">NDEX_H</span><span class="c">_BITS</span> <span class="c">=</span> <span class="w">7</span><span class="c">,</span>
	<span class="w">I</span><span class="pc">NDEX_L</span><span class="c">_BITS</span> <span class="pc">=</span> <span class="w">16</span><span class="c">,</span>
	<span class="w">I</span><span class="pc">NDEX_B</span><span class="c">ITS</span> <span class="c">=</span> <span class="w">I</span><span class="pc">NDEX_H</span><span class="c">_BITS</span> <span class="w">+</span> <span class="w">I</span><span class="pc">NDEX_L</span><span class="c">_BITS</span><span class="w">,</span>
	<span class="pc">N</span><span class="c">ODE_BITS</span> <span class="pc">=</span> <span class="w">32</span> <span class="w">-</span> <span class="w">T</span><span class="pc">Y</span><span class="c">PE_BITS</span> <span class="w">-</span> <span class="w">I</span><span class="pc">NDEX_B</span><span class="c">ITS</span> 
      <span class="w">}</span><span class="pc">;</span>
<span class="c">#endif</span>

      <span class="w">e</span><span class="pc">n</span><span class="c">um</span> <span class="w">ID_Types</span> <span class="pc">{</span>
	<span class="w">ID_SPECIAL</span><span class="c">,</span>
	<span class="w">ID_UNUSED_1</span><span class="c">,</span>
	<span class="w">ID_EVENT</span><span class="c">,</span>
	<span class="w">ID_BARRIER</span><span class="c">,</span>
	<span class="w">ID_LOCK</span><span class="c">,</span>
	<span class="w">ID_UNUSED_5</span><span class="c">,</span>
	<span class="w">ID_MEMORY</span><span class="c">,</span>
	<span class="w">ID_UNUSED_7</span><span class="c">,</span>
	<span class="w">ID_PROCESSOR</span><span class="c">,</span>
	<span class="w">ID_PROCGROUP</span><span class="c">,</span>
	<span class="w">ID_INDEXSPACE</span><span class="c">,</span>
	<span class="w">ID_UNUSED_11</span><span class="c">,</span>
	<span class="w">ID_ALLOCATOR</span><span class="c">,</span>
	<span class="w">ID_UNUSED_13</span><span class="c">,</span>
	<span class="w">ID_INSTANCE</span><span class="c">,</span>
	<span class="w">ID_UNUSED_15</span><span class="c">,</span>
      <span class="c">};</span>

      <span class="pc">e</span><span class="c">num</span> <span class="w">ID_Specials</span> <span class="c">{</span>
	<span class="w">ID_INVALID</span> <span class="pc">=</span> <span class="c">0,</span>
	<span class="w">ID_GLOBAL_MEM</span> <span class="pc">= </span><span class="c">(</span><span class="w">1U</span> <span class="w">&lt;</span><span class="pc">&lt;</span> <span class="w">INDEX_H_BITS) -</span> <span class="pc">1</span><span class="c">,</span>
      <span class="c">};</span>

      <span class="w">ID</span><span class="c">(</span><span class="w">IDType</span> <span class="w">_value);</span>

      <span class="w">t</span><span class="pc">e</span><span class="c">mplate</span> <span class="c">&lt;</span><span class="w">c</span><span class="c">lass</span> <span class="w">T</span><span class="pc">&gt;</span>
      <span class="w">ID</span><span class="c">(</span><span class="w">T</span> <span class="w">thing_to_get_id_from);</span>

      <span class="w">ID</span><span class="pc">(</span><span class="w">ID_Types</span> <span class="w">_type</span><span class="pc">,</span> <span class="w">u</span><span class="c">nsigned</span> <span class="w">_node</span><span class="c">,</span> <span class="w">ID</span><span class="pc">T</span><span class="c">ype</span> <span class="w">_index)</span><span class="pc">;</span>
      <span class="w">ID</span><span class="c">(</span><span class="w">ID</span><span class="pc">_T</span><span class="c">ypes</span> <span class="w">_</span><span class="pc">t</span><span class="c">ype,</span> <span class="pc">u</span><span class="c">nsigned</span> <span class="w">_</span><span class="pc">n</span><span class="c">ode</span><span class="pc">,</span> <span class="w">I</span><span class="pc">D</span><span class="c">Type</span> <span class="w">_index_h</span><span class="pc">,</span> <span class="w">I</span><span class="c">DType</span> <span class="w">_index_l</span><span class="pc">)</span><span class="c">;</span>

      <span class="w">b</span><span class="c">ool</span> <span class="pc">o</span><span class="c">perator</span><span class="w">==(</span><span class="c">const</span> <span class="w">I</span><span class="pc">D</span><span class="c">&amp;</span> <span class="c">rhs)</span> <span class="pc">c</span><span class="c">onst</span><span class="pc">;</span>

      <span class="w">I</span><span class="pc">DT</span><span class="c">ype</span> <span class="w">i</span><span class="c">d</span><span class="pc">(v</span><span class="c">oid)</span> <span class="c">const</span><span class="pc">;</span>
      <span class="w">ID</span><span class="pc">_</span><span class="c">Types</span> <span class="w">type</span><span class="c">(void)</span> <span class="c">const;</span>
      <span class="w">u</span><span class="c">nsigned</span> <span class="w">n</span><span class="c">ode(</span><span class="pc">v</span><span class="c">oid)</span> <span class="c">const</span><span class="pc">;</span>
      <span class="w">I</span><span class="c">DType</span> <span class="w">in</span><span class="pc">d</span><span class="c">ex</span><span class="pc">(</span><span class="c">void)</span> <span class="c">const</span><span class="pc">;</span>
      <span class="w">I</span><span class="pc">DT</span><span class="c">ype</span> <span class="w">index_h</span><span class="c">(</span><span class="pc">v</span><span class="c">oid)</span> <span class="c">const;</span>
      <span class="w">I</span><span class="pc">D</span><span class="c">Type</span> <span class="w">index_l</span><span class="c">(void)</span> <span class="c">const;</span>

      <span class="w">t</span><span class="pc">e</span><span class="c">mplate</span> <span class="c">&lt;</span><span class="w">c</span><span class="pc">l</span><span class="c">ass</span> <span class="c">T</span><span class="pc">&gt;</span>
      <span class="w">T</span> <span class="w">convert</span><span class="c">(void)</span> <span class="c">const;</span>

    <span class="w">p</span><span class="pc">r</span><span class="c">otected:</span>
      <span class="w">I</span><span class="c">DType</span> <span class="w">v</span><span class="pc">a</span><span class="c">lue;</span>
    <span class="pc">}</span><span class="c">;</span>
	
<span class="c">};</span> 

<span class="pc">#</span><span class="c">include</span> <span class="c">"</span><span class="w">id</span><span class="c">.</span><span class="w">inl</span><span class="pc">"</span>

<span class="c">#</span><span class="pc">e</span><span class="c">ndif</span> 


</pre>
</body>
</html>

